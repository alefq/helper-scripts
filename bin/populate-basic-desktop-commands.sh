#!/bin/bash
function f_check_commands ()
{
	lsb_release -d
	ERR_CODE=$?
	if [ ${ERR_CODE} -ne 0 ]; then
		echo "Command lsb_release returned an error: ${ERR_CODE}" 
		echo "Please check that is installed and in your excecution PATH"
		exit 1
	fi
}

f_check_commands
this_distro="`lsb_release -s -i`"
COMMANDS="filemanager imageviewer archivecompressor browser \
	mailcomposer torrentmanager texteditor diffmanager imageeditor \
	terminal videoplayer musicplayer"
CONF_DIR="../conf/command-by-distro"
for cmd in ${COMMANDS}; do
	SCRIPT="${cmd}.sh"
	echo "#!/bin/bash" > ${SCRIPT}
	echo "#"  >> ${SCRIPT}
	echo "# ${this_distro}: ${cmd}" >> ${SCRIPT}
	echo "#"  >> ${SCRIPT}
	echo "# File autogenerated by ${0} - DON NOT MANUALLY EDIT " >> ${SCRIPT}
	echo "# Generated by ${USER}@${HOSTNAME} - on `date`" >> ${SCRIPT}
	echo "#"  >> ${SCRIPT}
	echo "" >> ${SCRIPT}
	CURRENT="`grep $this_distro ${CONF_DIR}/${cmd}.list | awk -F: '{print $2}'`" 
	if [ -z $CURRENT ]; then
		echo "${cmd} is not defined for distribution: ${this_distro}"
	else
		which ${CURRENT} > /tmp/out 2>&1 
		ERR_CODE=$?
		if [ ${ERR_CODE} -ne 0 ]; then	
			echo "Command: ${cmd} not found"
		fi
		echo "${CURRENT} \"\$@\"" >> ${SCRIPT}
	fi
	echo "" >> ${SCRIPT}
	chmod +x ${SCRIPT}
done	

